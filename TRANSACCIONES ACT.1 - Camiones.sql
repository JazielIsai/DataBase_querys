CREATE DATABASE BDCAMIONES;
USE BDCAMIONES; 

CREATE TABLE CAMIONES(
NO_ECONOMICO VARCHAR(10) NOT NULL PRIMARY KEY, 
PLACAS VARCHAR(10) NOT NULL,
NO_PASAJEROS INT NOT NULL);

CREATE TABLE CONDUCTORES(
LICENCIA VARCHAR(10) NOT NULL PRIMARY KEY,
NOMBRE CHAR (30) NOT NULL, 
DOMICILIO VARCHAR (50) NOT NULL, 
TELEFONO INT NOT NULL, 
NO_ECONOMICO VARCHAR(10) NOT NULL,
CONSTRAINT FK_NO_ECONOMICO FOREIGN KEY (NO_ECONOMICO) REFERENCES CAMIONES(NO_ECONOMICO));

CREATE TABLE ALUMOS(
NO_ALUMNO INT NOT NULL PRIMARY KEY,
NOMBRE CHAR(30) NOT NULL,
GRUPO VARCHAR(3) NOT NULL, 
TELEFONO INT NOT NULL, 
NO_ECONOMICO VARCHAR(10) NOT NULL,
CONSTRAINT FK_NO_ECONOMICO1 FOREIGN KEY (NO_ECONOMICO) REFERENCES CAMIONES(NO_ECONOMICO));

CREATE TABLE CALLES(
ID_CALLE INT NOT NULL PRIMARY KEY, 
CALLE VARCHAR(30) NOT NULL,
COLONIA VARCHAR(30) NOT NULL,
HORARIO DATETIME NOT NULL);

CREATE TABLE RUTAS(
ID_RUTA INT NOT NULL PRIMARY KEY,
NO_ECONOMICO VARCHAR(10) NOT NULL,
ID_CALLE INT NOT NULL,
CONSTRAINT FK_NO_ECONOMICO2 FOREIGN KEY (NO_ECONOMICO) REFERENCES CAMIONES(NO_ECONOMICO),
CONSTRAINT FK_ID_CALLE FOREIGN KEY (ID_CALLE) REFERENCES CALLES(ID_CALLE));


delete from CAMIONES;
delete from CONDUCTORES;
delete from CALLES;
delete from ALUMOS;
delete from RUTAS;



--1.	Ingresar por medio de código registros a las tablas por lo menos 5 registros
INSERT INTO CAMIONES  VALUES ('CC-2E20','CA-SAB254',30)
INSERT INTO CAMIONES  VALUES ('CC-2E30','CA-SAB255',30)
INSERT INTO CAMIONES  VALUES ('CC-2E40','CA-SAB256',30)
INSERT INTO CAMIONES  VALUES ('CC-2E50','CA-SAB257',30)
INSERT INTO CAMIONES  VALUES ('CC-2E60','CA-SAB258',30)

INSERT INTO CONDUCTORES VALUES ('ABCD321','Isamel Garcia','Juarez',4621012131,'CC-2E20');
INSERT INTO CONDUCTORES VALUES ('ABCE321','Jaziel Isaí','Arandas',462379128, 'CC-2E30');
INSERT INTO CONDUCTORES VALUES ('ABCF321','Yael Rangel','Florentino',332191221, 'CC-2E40');
INSERT INTO CONDUCTORES VALUES ('ABCG321','Zaret Vera','Juventino Rosas',34112674, 'CC-2E50');
INSERT INTO CONDUCTORES VALUES ('ABCH321','Hiram Vera','Plutarco',341579146, 'CC-2E60');

INSERT INTO ALUMOS VALUES (18110111, 'Zabdiel Vera', '6A',34122922,'CC-2E20')
INSERT INTO ALUMOS VALUES (18110112, 'Isai Garrido', '6A',462349278,'CC-2E30')
INSERT INTO ALUMOS VALUES (18110113, 'Yaretsi Rangel', '6A',332631279,'CC-2E40')
INSERT INTO ALUMOS VALUES (18110114, 'Mariel Alosno', '6A',462129276,'CC-2E50')
INSERT INTO ALUMOS VALUES (18110115, 'Mara Vera', '6A',34163927521,'CC-2E60')

INSERT INTO CALLES VALUES (1112,'Benito Jaurez','Juarez','2021-01-10 07:15:00');
INSERT INTO CALLES VALUES (1113,'Real Galaxia de Arandas','Arandas','2021-01-10 07:00:00');
INSERT INTO CALLES VALUES (1114,'Florentino Rosas','Florentino','2021-01-10 07:30:00');
INSERT INTO CALLES VALUES (1115,'Guanajauto','Juventino Rosas','2021-01-10 07:20:00');
INSERT INTO CALLES VALUES (1116,'Diaz ordaz','Plutarco','2021-01-10 07:05:00');

INSERT INTO RUTAS VALUES (112,'CC-2E20',1112)
INSERT INTO RUTAS VALUES (113,'CC-2E30',1113)
INSERT INTO RUTAS VALUES (114,'CC-2E40',1114)
INSERT INTO RUTAS VALUES (115,'CC-2E50',1115)
INSERT INTO RUTAS VALUES (116,'CC-2E60',1116)
--2 2.	Insertar un registro en la tabla Camiones.
USE BDCAMIONES 
BEGIN BEGIN TRANSACTION;
Insert into dbo.CAMIONES(NO_ECONOMICO,PLACAS,NO_PASAJEROS) 
values('SA-1070','GA-SAB255', 30) COMMIT TRANSACTION;
END

select *from CAMIONES
--3
USE BDCAMIONES 
BEGIN BEGIN TRANSACTION; 
Insert into dbo.ALUMOS(NO_ALUMNO,NOMBRE,GRUPO,TELEFONO,NO_ECONOMICO) 
values('18110119','Miguel Gutierrez','8A','464123456', 'SA-1070') COMMIT TRANSACTION; 
END
select *from ALUMOS
--4
	USE BDCAMIONES BEGIN BEGIN TRANSACTION; 
	Select E.NO_ECONOMICO AS NO_ECONOMICO,E.ID_RUTA 
	AS ID_RUTA, D.CALLE AS CALLE From RUTAS E JOIN CALLES D ON E.ID_CALLE = D.ID_CALLE
	ROLLBACK TRANSACTION; END
--5
	USE BDCAMIONES 
	BEGIN BEGIN TRANSACTION; 
	Select E.NOMBRE AS NOMBRE,E.LICENCIA AS LICENCIA, E.NO_ECONOMICO
	AS NO_ECONOMICO, D.ID_RUTA From CONDUCTORES E JOIN RUTAS D 
	ON E.NO_ECONOMICO = D.NO_ECONOMICO
	ROLLBACK TRANSACTION; END

--6
	USE BDCAMIONES
	BEGIN BEGIN TRANSACTION;
	Select E.NOMBRE AS NOMBRE,D.ID_RUTA, D.NO_ECONOMICO
	AS NO_ECONOMICO,D.ID_CALLE AS CALLE From 
	ALUMOS E JOIN Rutas D ON E.NO_ECONOMICO = D.NO_ECONOMICO
	WHERE D.ID_CALLE like '%1112%';
	ROLLBACK TRANSACTION; END

